<div class="profiler-wrapper">
  <mat-card>
    @if (state === 'idle') {
      <button
        mat-icon-button
        color="primary"
        (click)="startRecording()"
        class="profiler-control start-recording-button"
        matTooltip="Start recording"
        >
        <mat-icon> circle </mat-icon>
      </button>
    } @else if (state === 'recording') {
      <button
        mat-icon-button
        (click)="stopRecording()"
        class="profiler-control recording-button"
        matTooltip="Stop recording"
        >
        <mat-icon> circle </mat-icon>
      </button>
    } @else if (state === 'visualizing') {
      <button
        mat-icon-button
        color="primary"
        (click)="discardRecording()"
        class="profiler-control discard-button"
        matTooltip="Clear recording"
        >
        <mat-icon> not_interested </mat-icon>
      </button>
    }
    <div class="instructions" [class.hidden]="state !== 'idle'" style="width: 100%;">
      <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;"> 
        <span> Click the record button to start a new recording, or upload a json file containing profiler data. </span>
        <button mat-icon-button color="primary" type="button" title="Upload report data" (click)="profileUpload.click()">
          <mat-icon> upload </mat-icon>
        </button>
        <input #profileUpload style="display: none;" type="file" (change)="importProfilerResults($event)" placeholder="Upload file" accept=".json" />
      </div>  
    </div>
    <p class="instructions" [class.hidden]="state !== 'recording'">
      Interact to preview change detection. Clicking stop ends this Profiler recording.
    </p>
    <p class="instructions" [class.hidden]="state !== 'visualizing'">
      Click Save Profile to save your recording or click refresh to clear the current recording.
    </p>
  </mat-card>
  <div id="profiler-content-wrapper">
    @if (state !== 'idle') {
      <div class="visualization">
        <ng-recording-timeline [stream]="stream" (exportProfile)="exportProfilerResults()"/>
      </div>
    }
  </div>
</div>
